#!/usr/bin/env sh

. './bin/muzert-spotify'

update_token() {
	local token="$(get_token)"

	sed -i .env "s/ACCESS_TOKEN=.*/ACCESS_TOKEN=$token/"
}

should_update_token() {
	local last_update=$(stat -c "%Y" .env)
	local now=$(date '+%s')
	local hour=$(expr 60 '*' 60)

	[ "$last_update" -lt "$(expr $now - $hour)" ]
	return $?
}

should_update_token && update_token
